---
show: step
version: 1.0
enable_checker: true
---

# äºŒé‡å¾ªç¯

## å›å¿†

- ä¸Šæ¬¡æˆ‘ä»¬æŠŠå®¹å™¨åºåˆ—åŒ–äº†
	- å¹¶ä¸”å­˜å‚¨åœ¨æ–‡ä»¶å½“ä¸­
	- è¿™äº›å®¹å™¨æ˜¯é‡è¦çš„æ•°æ®ç»“æ„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/203868/uid1190679-20250728-1753711046352) 

- æ‰“å¼€æ–‡ä»¶ä¹‹å 
	- å¾—åˆ°äº†f
- è¿™f æ˜¯ `ä»€ä¹ˆ`ç±»å‹çš„ å˜é‡ å‘¢ï¼ŸğŸ¤”

### åŸºç¡€å‡†å¤‡

```
echo "æœ¨,ç«,åœŸ,é‡‘,æ°´" >> wuxing.txt
echo "é’,èµ¤,é»„,ç™½,é»‘" >> wuxing.txt
echo "ä¸œ,å—,ä¸­,è¥¿,åŒ—" >> wuxing.txt
echo "è‚,å¿ƒ,è„¾,è‚º,è‚¾" >> wuxing.txt
echo "ç”Ÿ,é•¿,åŒ–,æ”¶,è—" >> wuxing.txt
cat wuxing.txt
```

- å…ˆå‡†å¤‡è¿™æ ·ä¸€ä¸ªwuxing.txtæ–‡ä»¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/234372/uid1190679-20250728-1753712209692) 

- æˆ‘ä»¬æ˜¯æ€ä¹ˆå¾—åˆ°æ–‡ä»¶çš„å‘¢ï¼Ÿ

### å®šä¹‰

- è¿›å…¥æ¸¸ä¹åœº

```
python3
```

- æˆ‘ä»¬é¦–å…ˆè¯»ä¸€ä¸ªæ–‡ä»¶

```
with open("wuxing.txt", "rt") as f:
	print(type(f))
```

- ç„¶åçœ‹çœ‹
	- è¿™ä¸ªæ–‡ä»¶å…·ä½“æ˜¯ä»€ä¹ˆ type çš„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633956068396)

- ä»€ä¹ˆæ˜¯ TextIOWrapper å‘¢ï¼Ÿ

### TextIOWrapper

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633957157884)

- æŸ¥çœ‹å¸®åŠ©

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633957166532)

- ç»§ç»­å¾€åç¿»

### iter æ–¹æ³•

- æˆ‘æ‰¾åˆ°äº†è¿™ä¸ª

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633957201999)

- è¿™è¯´æ˜ TextIOWrapper æ˜¯ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡
	- å¯ä»¥ç”¨ for æ¥éå†ä»–


### éå†

```
with open("wuxing.txt","rt") as f:
    for line in f:
        print(line)
```

- éå†å¾ˆå¥½ç”¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633957276251)

- æˆ‘ä»¬å¯ä»¥ç»™ä»–åŠ ä¸€ä¸ªç¼–å·ä¹ˆï¼Ÿ

### ç¼–å·

```
with open("wuxing.txt","rt") as f:
    for line in enumerate(f):
        print(line)
```

- enumerate 
	- ç»™ å¯è¿­ä»£å˜é‡ ç¼åˆä¸ªç¼–å·

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633957376053)

- æˆ‘å¯ä»¥æŠŠ
	- çºµå‘çš„åˆ—
	- ç¼åˆåˆ°ä¸€èµ·ä¹ˆï¼Ÿ

### å‡†å¤‡ç¼åˆ zip

```
lst = []
with open("wuxing.txt","rt") as f:
    for line in f:
		lst.append(line.replace("\n", "").split(","))	 
        print(line)
print(lst)
```

- é¦–å…ˆ æŠŠæ–‡ä»¶ åˆ¶ä½œä¸º äºŒä½æ•°ç»„
	- ç„¶å æƒ³åŠæ³• ç¼åˆ åŒä¸€ä½ç½®çš„ å…ƒç´ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633958241633)

- å…¶å®æ˜¯ çŸ©é˜µè½¬ç½®
	- matrix transposition

### ç¼åˆ zip

```
lst = []
with open("wuxing.txt","rt") as f:
    for line in f:
		lst.append(line.replace("\n", "").split(","))	 
        print(line)
print(lst)
z = zip(l[0], l[1], l[2], l[3], l[4])
for row in z:
	print(row)
```

- è¿™æ ·åŒå£°ç›¸åº” åŒæ°”ç›¸æ±‚

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633958317886)

- åŒæ ·ç±»å‹çš„ä¸œè¥¿å°±æ˜ å°„åˆ°ä¸€èµ·äº†

### é˜´é˜³åº”è±¡å¤§è®ºç¯‡ç¬¬äº”

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211011-1633958585440)

### éœ€æ±‚

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/3584/labs/234372/uid1190679-20250309-1741528873406) 


```
import os
import shutil
import exifread
from datetime import datetime
from pathlib import Path


def get_capture_date(file_path):
    """ä¸¥æ ¼æ¨¡å¼ï¼šä»…ä½¿ç”¨EXIFæ—¥æœŸï¼Œä¸è‡ªåŠ¨å›é€€åˆ°ä¿®æ”¹æ—¶é—´"""
    try:
        with open(file_path, 'rb') as f:
            tags = exifread.process_file(f, stop_tag='DateTimeOriginal')
            if 'EXIF DateTimeOriginal' in tags:
                date_str = str(tags['EXIF DateTimeOriginal'])
                return datetime.strptime(date_str, '%Y:%m:%d %H:%M:%S')
    except Exception as e:
        print(f"EXIFè¯»å–å¤±è´¥ {file_path}: {str(e)}")
    return None  # ä¸¥æ ¼æ¨¡å¼ä¸è‡ªåŠ¨ä½¿ç”¨ä¿®æ”¹æ—¶é—´


def organize_photos(source_dir, output_base):
    """æ•´ç†ç…§ç‰‡ä¸»å‡½æ•°ï¼ˆæ–°å¢æ— æ—¥æœŸåˆ†ç±»ï¼‰"""
    image_exts = {'.jpg', '.jpeg', '.png', '.cr2', '.nef', '.dng'}

    for file_path in Path(source_dir).rglob('*'):
        if file_path.suffix.lower() not in image_exts:
            continue

        try:
            # è·å–æ‹æ‘„æ—¥æœŸ
            capture_date = get_capture_date(file_path)

            # ç¡®å®šç›®æ ‡è·¯å¾„
            if capture_date:  # æœ‰EXIFæ—¥æœŸçš„æƒ…å†µ
                date_folder = capture_date.strftime("%Y/%m/%d")
                dest_dir = Path(output_base) / date_folder
            else:  # æ— æ—¥æœŸä¿¡æ¯çš„æƒ…å†µ
                dest_dir = Path(output_base) / "æ— æ—¥æœŸä¿¡æ¯"

            # åˆ›å»ºç›®å½•å¹¶å¤„ç†é‡å
            dest_dir.mkdir(parents=True, exist_ok=True)
            dest_path = dest_dir / file_path.name
            counter = 1
            while dest_path.exists():
                dest_path = dest_dir / f"{file_path.stem}_{counter}{file_path.suffix}"
                counter += 1

            # ç§»åŠ¨æ–‡ä»¶
            shutil.move(str(file_path), str(dest_path))
            status = "æ— æ—¥æœŸ" if not capture_date else capture_date.strftime("%Y-%m-%d")
            print(f"Moved [{status}]: {file_path.name}")

        except Exception as e:
            print(f"å¤„ç†å¤±è´¥ {file_path.name}: {str(e)}")


if __name__ == "__main__":
    sd_card_path = "/media/your_sd_card"
    output_directory = "/photo_collection"

    organize_photos(sd_card_path, output_directory)


```

### æ€»ç»“

- æœ¬ç« èŠ‚ ç ”ç©¶äº† æ–‡ä»¶æµå¯¹è±¡çš„ éå†	
	- æ–‡ä»¶æµ æœ¬è´¨ æ˜¯iterable çš„å¯¹è±¡
		- å¯ä»¥æ˜¯ æ–‡æœ¬æµ 
		- ä¹Ÿå¯ä»¥æ˜¯å­—èŠ‚æµ
	- è¿˜å¯ä»¥éå† æ•´ä¸ªæ–‡ä»¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20250728-1753712886306)

- å…³äº æ–‡æœ¬å¤„ç† è¿˜æœ‰ä»€ä¹ˆè¯´æ³•å—ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´ ğŸ‘‹
